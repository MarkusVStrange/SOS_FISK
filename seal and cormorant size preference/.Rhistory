df <- aggregate(N~Age+Quarter+Year,data=ca_cod,FUN=sum)
library(dplyr)
d <- rbind(readRDS("N_Cod1.RData"),readRDS("N_Cod4.RData"))
df <- aggregate(N~Age+Quarter+Year,data=d,FUN=sum)
df$FishingDur <- aggregate(FishingDur~Age+Quarter+Year,data=d,FUN=mean)$FishingDur
df$cpue <- df$N/df$FishingDur*60  # ind. pr. hour
df1 <- df %>% filter(Quarter==1)
table(df1$Year)
View(df1)
d$Age[d$Age>7] <- 7
df <- aggregate(N~Age+Quarter+Year,data=d,FUN=sum)
df$FishingDur <- aggregate(FishingDur~Age+Quarter+Year,data=d,FUN=mean)$FishingDur
df$cpue <- df$N/df$FishingDur*60  # ind. pr. hour
df1 <- df %>% filter(Quarter==1)
dat1 <- data.frame(A1=df1$cpue[df1$Age==1],A2=df1$cpue[df1$Age==2],A3=df1$cpue[df1$Age==3],
A4=df1$cpue[df1$Age==4],A5=df1$cpue[df1$Age==5],A6=df1$cpue[df1$Age==6],A7=df1$cpue[df1$Age==7])
table(df1$Year)
df1 <- df %>% filter(Quarter==1 & Age>0)
table(df1$Year)
View(d)
t <- d %>% filter(Year==2025 & Quarter==1)
View(t)
#remotes::install_github("DTUAqua/DATRAS/DATRAS")
#remotes::install_github("casperwberg/surveyIndex/surveyIndex")
library(surveyIndex)
library(sf)
library(reshape2)
library(tidyverse)
data_wd <- paste(dirname(dirname(getwd())),"/SOS data/",sep="")
#dAll <- readRDS(paste(data_wd,"DatrasExchange.R",sep=""))
dAll <- readRDS("datras.R")
WB <- st_read(paste(data_wd,"shapefiles/ICES_areas.shp",sep=""))
plot(WB %>% filter(ICES_SUB %in% 22:24))
WB <- as(WB,"Spatial")
dAll <- addSpatialData(dAll,WB)
# Cod ALK Q1
#####
mc.cores<-1; library(parallel)
years <- 1991:2025
codQ1 <- data.frame(LngtCm=NA,Age=NA,N=NA,Year=NA,Quarter=NA,qday=NA,Species="O",FishingDur=NA)
i=2025
d<-subset(dAll, Species=="Gadus morhua",Quarter==1,ICES_SUB %in% 22:24,Year==i)
d<-addSpectrum(d,by=1)
## get idea about number of age groups to include
agetab<-xtabs(NoAtALK~Year+Age,data=d[[1]])
ages <- sort(unique(d[["CA"]]$Age))
if(sum(diff(ages))!=(length(ages)-1)){
ages <- ages[1:which(diff(ages)>1)]
}
d <- subset(d,Age %in% ages)
d<-subset(dAll, Species=="Gadus morhua",Quarter==1,ICES_SUB %in% 22:24,Year==i)
d<-subset(dAll, Species=="Gadus morhua",Quarter==1,ICES_SUB %in% 22:24,Year==i)
#remotes::install_github("DTUAqua/DATRAS/DATRAS")
#remotes::install_github("casperwberg/surveyIndex/surveyIndex")
library(surveyIndex)
library(sf)
library(reshape2)
library(tidyverse)
data_wd <- paste(dirname(dirname(getwd())),"/SOS data/",sep="")
#dAll <- readRDS(paste(data_wd,"DatrasExchange.R",sep=""))
dAll <- readRDS("datras.R")
WB <- st_read(paste(data_wd,"shapefiles/ICES_areas.shp",sep=""))
plot(WB %>% filter(ICES_SUB %in% 22:24))
WB <- as(WB,"Spatial")
dAll <- addSpatialData(dAll,WB)
# Cod ALK Q1
#####
mc.cores<-1; library(parallel)
years <- 1991:2025
codQ1 <- data.frame(LngtCm=NA,Age=NA,N=NA,Year=NA,Quarter=NA,qday=NA,Species="O",FishingDur=NA)
# Cod ALK Q1
#####
mc.cores<-1; library(parallel)
years <- 1991:2025
years
1991:2025
d<-subset(dAll, Species=="Gadus morhua",Quarter==1,ICES_SUB %in% 22:24,Year==i)
d<-addSpectrum(d,by=1)
## get idea about number of age groups to include
agetab<-xtabs(NoAtALK~Year+Age,data=d[[1]])
ages <- sort(unique(d[["CA"]]$Age))
if(sum(diff(ages))!=(length(ages)-1)){
ages <- ages[1:which(diff(ages)>1)]
}
d <- subset(d,Age %in% ages)
d<-addSpectrum(d,by=1)
d.ysplit <- split(d, d$Year)
ALK<-mclapply(d.ysplit,fitALK,minAge=min(ages),maxAge=max(ages),autoChooseK=TRUE,useBIC=TRUE,
varCof=FALSE,maxK=50,mc.cores=mc.cores)
ca <- d[["CA"]]
View(ca)
table(ca$Age)
df1 <- df %>% filter(Quarter==1 & Age>0 & Year<2025)
table(df1$Year)
library(dplyr)
d <- rbind(readRDS("N_Cod1.RData"),readRDS("N_Cod4.RData"))
d$Age[d$Age>7] <- 7
df <- aggregate(N~Age+Quarter+Year,data=d,FUN=sum)
df$FishingDur <- aggregate(FishingDur~Age+Quarter+Year,data=d,FUN=mean)$FishingDur
df$cpue <- df$N/df$FishingDur*60  # ind. pr. hour
df1 <- df %>% filter(Quarter==1 & Age>0 & Year<2025)
table(df1$Year)
df1 <- df %>% filter(Quarter==1 & Age>0 & Age<6)
table(df1$Year)
dat1 <- data.frame(A1=df1$cpue[df1$Age==1],A2=df1$cpue[df1$Age==2],A3=df1$cpue[df1$Age==3],
A4=df1$cpue[df1$Age==4],A5=df1$cpue[df1$Age==5])
dat1
df4 <- df %>% filter(Quarter==4)
df4 <- df %>% filter(Quarter==4 & Age<8)
table(df4$Year)
df4 <- df %>% filter(Quarter==4 & Age<5)
table(df4$Year)
df4 <- df %>% filter(Quarter==4 & Age<6)
table(df4$Year)
df4 <- df %>% filter(Quarter==4 & Age<7)
dat1 <- data.frame(A1=df1$cpue[df1$Age==1],A2=df1$cpue[df1$Age==2],A3=df1$cpue[df1$Age==3],
A4=df1$cpue[df1$Age==4],A5=df1$cpue[df1$Age==5])
table(df4$Year)
df4 <- df %>% filter(Quarter==4 & Age<6)
df4$Age[df4$Year==2015]
df4 <- df %>% filter(Quarter==4 & Age<5)
table(df4$Year)
df4 <- df %>% filter(Quarter==4 & Age<4)
table(df4$Year)
df4$Age[df4$Year==2018]
library(devtools)
install_github("nielshintzen/vmstools/vmstools/")
warnings()
library(vmstools)
warnings()
data(tacsat); data(eflalo)
#Let's have a look at what they look like
str(tacsat)
#- We can get a summary too
summarizeTacsat(tacsat)
str(eflalo)
str(eflalo[,1:20])
# Get a summary of eflalo
summarizeEflalo(eflalo)
head(eflalo)
head(eflalo[,1:20])
head(eflalo[,33:52])
head(eflalo[,32:52])
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
eflalo <- formatEflalo(eflalo)
#First split the tacsat data into a 1800 and 1801 dataset
# To get a simple tacsat date timestap, use the sortTacsat function
require(lubridate)
tacsat <- sortTacsat(tacsat)
tacsat$YEAR <- year(tacsat$SI_DATIM)
#Split the data
tacsat1800 <- subset(tacsat,YEAR == 1800)
tacsat1801 <- subset(tacsat,YEAR == 1801)
#Check if both datasets together hold the same number of records as the original tacsat dataset
nrow(tacsat1800) + nrow(tacsat1801) #96882
nrow(tacsat) #97051!!! So apparently, some date + time's are not converted properly, up to you to fix this!
#Write files to disk
write.table(tacsat1800, file = "C:/tmpTacsat/tacsat1800.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
write.table(tacsat1801, file = "C:/tmpTacsat/tacsat1801.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read it in again
years <- 1800:1801
path  <- "C:/tmpTacsat/"
totalTacsat <- numeric()
for(iYears in years){
tacsatYr <- readTacsat(paste(path,"tacsat",iYears,".csv",sep=""))
totalTacsat <- rbindTacsat(totalTacsat,tacsatYr)
}
head(totalTacsat) #Note the first rows of NA's, needs to be removed
totalTacsat <- totalTacsat[-1,]
nrow(totalTacsat) #96882 again!
names(tacsat)
names(eflalo[,1:20])
head(eflalo[,1:20])
head(eflalo[,32:52])
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
eflalo <- formatEflalo(eflalo)
head(eflalo)
names(eflalo)
eflalo$LE_KG_PLE
# exercise 2
#2)
sum(eflalo$LE_KG_PLE)
# exercise 2
#2)
paste(sum(eflalo$LE_KG_PLE),"kg plaice caught")
# exercise 2
#2)
paste(round(sum(eflalo$LE_KG_PLE)),"kg plaice caught")
##########
#First split the tacsat data into a 1800 and 1801 dataset
# To get a simple tacsat date timestap, use the sortTacsat function
require(lubridate)
tacsat <- sortTacsat(tacsat)
tacsat$YEAR <- year(tacsat$SI_DATIM)
#Split the data
tacsat1800 <- subset(tacsat,YEAR == 1800)
tacsat1801 <- subset(tacsat,YEAR == 1801)
#Check if both datasets together hold the same number of records as the original tacsat dataset
nrow(tacsat1800) + nrow(tacsat1801) #96882
nrow(tacsat) #97051!!! So apparently, some date + time's are not converted properly, up to you to fix this!
#Write files to disk
write.table(tacsat1800, file = "C:/tmpTacsat/tacsat1800.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
write.table(tacsat1801, file = "C:/tmpTacsat/tacsat1801.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read it in again
years <- 1800:1801
path  <- "C:/tmpTacsat/"
totalTacsat <- numeric()
for(iYears in years){
tacsatYr <- readTacsat(paste(path,"tacsat",iYears,".csv",sep=""))
totalTacsat <- rbindTacsat(totalTacsat,tacsatYr)
}
head(totalTacsat) #Note the first rows of NA's, needs to be removed
totalTacsat <- totalTacsat[-1,]
nrow(totalTacsat) #96882 again!
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
head(tacsat)
require(lubridate)
tacsat <- sortTacsat(tacsat)
tacsat$YEAR <- year(tacsat$SI_DATIM)
#Split the data
tacsat1800 <- subset(tacsat,YEAR == 1800)
tacsat1801 <- subset(tacsat,YEAR == 1801)
#Check if both datasets together hold the same number of records as the original tacsat dataset
nrow(tacsat1800) + nrow(tacsat1801) #96882
nrow(tacsat) #97051!!! So apparently, some date + time's are not converted properly, up to you to fix this!
#Write files to disk
write.table(tacsat1800, file = "C:/tmpTacsat/tacsat1800.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
write.table(tacsat1801, file = "C:/tmpTacsat/tacsat1801.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read it in again
years <- 1800:1801
path  <- "C:/tmpTacsat/"
totalTacsat <- numeric()
for(iYears in years){
tacsatYr <- readTacsat(paste(path,"tacsat",iYears,".csv",sep=""))
totalTacsat <- rbindTacsat(totalTacsat,tacsatYr)
}
head(totalTacsat) #Note the first rows of NA's, needs to be removed
totalTacsat <- totalTacsat[-1,]
nrow(totalTacsat) #96882 again!
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
#str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
#str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
head(tacsat)
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
#str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
#str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
require(lubridate)
tacsat <- sortTacsat(tacsat)
tacsat$YEAR <- year(tacsat$SI_DATIM)
#Split the data
tacsat1800 <- subset(tacsat,YEAR == 1800)
tacsat1801 <- subset(tacsat,YEAR == 1801)
#Check if both datasets together hold the same number of records as the original tacsat dataset
nrow(tacsat1800) + nrow(tacsat1801) #96882
nrow(tacsat) #97051!!! So apparently, some date + time's are not converted properly, up to you to fix this!
#Write files to disk
write.table(tacsat1800, file = "C:/tmpTacsat/tacsat1800.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
write.table(tacsat1801, file = "C:/tmpTacsat/tacsat1801.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read it in again
years <- 1800:1801
path  <- "C:/tmpTacsat/"
totalTacsat <- numeric()
for(iYears in years){
tacsatYr <- readTacsat(paste(path,"tacsat",iYears,".csv",sep=""))
totalTacsat <- rbindTacsat(totalTacsat,tacsatYr)
}
head(totalTacsat) #Note the first rows of NA's, needs to be removed
totalTacsat <- totalTacsat[-1,]
nrow(totalTacsat) #96882 again!
head(totalTacsat) #Note the first rows of NA's, needs to be removed
head(eflalo[,1:20])
str(eflalo)
# Exercise 4
VE_small <- subset(eflalo,as.numeric(VE_REF)<1000)
as.numeric(VE_REF)
# Exercise 4
VE_small <- eflalo %>% filter(as.numeric(eflaloE_REF)<1000)
# Exercise 4
VE_small <- eflalo %>% filter(as.numeric(VE_REF)<1000)
table(as.numeric(eflalo$VE_REF))
table((eflalo$VE_REF))
# Exercise 4
VE_small <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
# Exercise 4
VE_small <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
# Exercise 4
eflalo_small <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
eflalo_big <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
length(eflalo_big$VE_REF)
length(eflalo_small$VE_REF)
length(eflalo$VE_REF)
totTacsat_small <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
totTacsat_big <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
########################
# Practical 2
#######################
data(tacsat)
idx <- which(abs(tacsat$SI_LATI) > 90 | abs(tacsat$SI_LONG) > 180)
idx
#points not on the globe
idx <- unique(c(idx,which(tacsat$SI_HE < 0 | tacsat$SI_HE >  360)))
idx
#adding points with heading outside compass range
length(idx)
tacsat$SI_DATIM <- as.POSIXct(paste(tacsat$SI_DATE,tacsat$SI_TIME,sep=" "),
tz="GMT", format="%d/%m/%Y  %H:%M") # create a proper date-time stamp column by 'pasting' together VE_REF, the location and the date/time columns. This makes it straightforward to check for duplicates.
uniqueTacsat    <- paste(tacsat$VE_REF,tacsat$SI_LATI,tacsat$SI_LONG,tacsat$SI_DATIM)
uniqueTacsat[1:5] # check what the paste function did.
print(nrow(tacsat))
tacsat[!duplicated(uniqueTacsat),]
print(nrow(tacsat))
tacsat          <- tacsat[!duplicated(uniqueTacsat),] #get rid of the duplicates
print(nrow(tacsat))
data(europa) #a dataset already build into the package with the coastlines embedded
class(europa)
plot(europa,col='green')
idx     <- pointOnLand(tacsat,europa,st_crs=4326);
table(idx)
?pointOnLand
pol     <- tacsat[which(idx==1),] #points on land
#Overwrite the original tacsat dataset with only those points not on land
tacsat  <- tacsat[which(idx==0),] #tacsat not on land
# X11()
plot(st_geometry(europa),col="darkgreen",xlim=c(-4,10),ylim=c(48,62))
axis(1); axis(2)
points(x=pol$SI_LONG,y=pol$SI_LATI,col="red",pch=19,cex=0.5)
hist(tacsat$SI_SP,breaks=100) #are there any outlying results?
spThres <- 20 #I decide that 20knots is the maximum speed allowed in the dataset
idx <- which(tacsat$SI_SP > spThres)
tacsat <- tacsat[-idx,]
idx
data(tacsat); data(eflalo)
head(tacsat)
head(tacsat)
class(tacsat)
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
#str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
#str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
eflalo <- formatEflalo(eflalo)
# exercise 2
#3)
paste(round(sum(eflalo$LE_KG_PLE)),"kg plaice caught")
head(tacsat)
# exercise 2
#3)
paste(round(sum(eflalo$LE_KG_PLE)),"kg plaice caught")
First split the tacsat data into a 1800 and 1801 dataset
require(lubridate)
tacsat <- sortTacsat(tacsat)
tacsat$YEAR <- year(tacsat$SI_DATIM)
#Split the data
tacsat1800 <- subset(tacsat,YEAR == 1800)
tacsat1801 <- subset(tacsat,YEAR == 1801)
#Check if both datasets together hold the same number of records as the original tacsat dataset
nrow(tacsat1800) + nrow(tacsat1801) #96882
nrow(tacsat) #97051!!! So apparently, some date + time's are not converted properly, up to you to fix this!
#Write files to disk
write.table(tacsat1800, file = "C:/tmpTacsat/tacsat1800.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
write.table(tacsat1801, file = "C:/tmpTacsat/tacsat1801.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read it in again
years <- 1800:1801
path  <- "C:/tmpTacsat/"
totalTacsat <- numeric()
for(iYears in years){
tacsatYr <- readTacsat(paste(path,"tacsat",iYears,".csv",sep=""))
totalTacsat <- rbindTacsat(totalTacsat,tacsatYr)
}
head(totalTacsat) #Note the first rows of NA's, needs to be removed
totalTacsat <- totalTacsat[-1,]
nrow(totalTacsat) #96882 again!
# Exercise 4
eflalo_small <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
eflalo_big <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
totTacsat_small <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
totTacsat_big <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
dir.create("C:/tmpTacsat")
write.table(tacsat, file = "C:/tmpTacsat/tacsat.csv", quote = TRUE, sep = ",",
eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read in tacsat file
tacsat <- readTacsat("C:/tmpTacsat/tacsat.csv")
str(tacsat) #How does that look?
#Or we can use the build-in read.csv function from R
tacsat <- read.csv("C:/tmpTacsat/tacsat.csv")
#str(tacsat) #How does that look?
tacsat <- formatTacsat(tacsat)
#str(tacsat) #How about now?
tacsat <- formatTacsat(tacsat)
eflalo <- formatEflalo(eflalo)
head(tacsat)
data(tacsat); data(eflalo)
head(tacsat)
#First split the tacsat data into a 1800 and 1801 dataset
# To get a simple tacsat date timestap, use the sortTacsat function
require(lubridate)
tacsat <- sortTacsat(tacsat)
tacsat$YEAR <- year(tacsat$SI_DATIM)
#Split the data
tacsat1800 <- subset(tacsat,YEAR == 1800)
tacsat1801 <- subset(tacsat,YEAR == 1801)
#Check if both datasets together hold the same number of records as the original tacsat dataset
nrow(tacsat1800) + nrow(tacsat1801) #96882
nrow(tacsat) #97051!!! So apparently, some date + time's are not converted properly, up to you to fix this!
#Write files to disk
write.table(tacsat1800, file = "C:/tmpTacsat/tacsat1800.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
write.table(tacsat1801, file = "C:/tmpTacsat/tacsat1801.csv", quote = TRUE, sep = ",",eol = "\n", na = "NA", dec = ".", row.names = F,col.names = TRUE)
#Read it in again
years <- 1800:1801
path  <- "C:/tmpTacsat/"
totalTacsat <- numeric()
for(iYears in years){
tacsatYr <- readTacsat(paste(path,"tacsat",iYears,".csv",sep=""))
totalTacsat <- rbindTacsat(totalTacsat,tacsatYr)
}
head(totalTacsat) #Note the first rows of NA's, needs to be removed
totalTacsat <- totalTacsat[-1,]
nrow(totalTacsat) #96882 again!
# Exercise 4
eflalo_small <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
eflalo_big <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
totTacsat_small <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
totTacsat_big <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
nrow(totalTacsat)
# Exercise 4
eflalo_small <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
eflalo_big <- eflalo %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
totTacsat_small <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)<1000)
totTacsat_big <- totalTacsat %>% filter(as.numeric(VE_REF,rm.na=TRUE)>=1000)
# cod growth functions
#####
d <- rbind(readRDS("N_Cod1.RData"),readRDS("N_Cod4.RData"))
ca_cod <- d %>% filter(N!=0)
ca_cod$cohort <- ca_cod$Year-ca_cod$Age
ca_cod$t <- ca_cod$Age+ca_cod$qday
names(ca_cod)[names(ca_cod)=="LngtCm"] <- "Length"
df <- ca_cod %>% select(Length,t,cohort,N,Year,Species,Age)
setwd("~/GitHub/SOS_FISK/seal and cormorant size preference")
# cod growth functions
#####
d <- rbind(readRDS("N_Cod1.RData"),readRDS("N_Cod4.RData"))
ca_cod <- d %>% filter(N!=0)
ca_cod$cohort <- ca_cod$Year-ca_cod$Age
ca_cod$t <- ca_cod$Age+ca_cod$qday
names(ca_cod)[names(ca_cod)=="LngtCm"] <- "Length"
df <- ca_cod %>% select(Length,t,cohort,N,Year,Species,Age)
